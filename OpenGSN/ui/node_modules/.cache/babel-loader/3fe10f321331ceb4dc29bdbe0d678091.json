{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst axios_1 = __importDefault(require(\"axios\"));\n\nconst LOGMAXLEN = 120;\nconst DEFAULT_TIMEOUT = 15000;\n\nclass HttpWrapper {\n  constructor() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    let logreq = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    this.provider = axios_1.default.create(Object.assign({\n      timeout: DEFAULT_TIMEOUT,\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }, opts));\n    this.logreq = logreq;\n\n    if (this.logreq) {\n      this.provider.interceptors.response.use(function (response) {\n        console.log('got response:', response.config.url, JSON.stringify(response.data).slice(0, LOGMAXLEN));\n        return response;\n      }, async function (error) {\n        const errData = error.response != null ? error.response.data : {\n          error: error.message\n        };\n        const errStr = (typeof errData === 'string' ? errData : JSON.stringify(errData)).slice(0, LOGMAXLEN);\n        const errUrl = error.response != null ? error.response.config.url : error.address;\n        console.log('got response:', errUrl, 'err=', errStr);\n        return await Promise.reject(error);\n      });\n    }\n  }\n\n  async sendPromise(url, jsonRequestData) {\n    if (this.logreq) {\n      console.log('sending request:', url, JSON.stringify(jsonRequestData !== null && jsonRequestData !== void 0 ? jsonRequestData : {}).slice(0, LOGMAXLEN));\n    }\n\n    const response = await this.provider.request({\n      url,\n      method: jsonRequestData != null ? 'POST' : 'GET',\n      data: jsonRequestData\n    });\n    return response.data;\n  }\n\n}\n\nexports.HttpWrapper = HttpWrapper;","map":{"version":3,"sources":["../src/HttpWrapper.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,MAAA,OAAA,GAAA,eAAA,CAAA,OAAA,CAAA,OAAA,CAAA,CAAA;;AAEA,MAAM,SAAS,GAAG,GAAlB;AACA,MAAM,eAAe,GAAG,KAAxB;;AAEA,MAAa,WAAb,CAAwB;AAItB,EAAA,WAAA,GAAmE;AAAA,QAAtD,IAAsD,uEAA3B,EAA2B;AAAA,QAAvB,MAAuB,uEAAL,KAAK;AACjE,SAAK,QAAL,GAAgB,OAAA,CAAA,OAAA,CAAM,MAAN,CAAa,MAAM,CAAC,MAAP,CAAc;AACzC,MAAA,OAAO,EAAE,eADgC;AAEzC,MAAA,OAAO,EAAE;AAAE,wBAAgB;AAAlB;AAFgC,KAAd,EAG1B,IAH0B,CAAb,CAAhB;AAIA,SAAK,MAAL,GAAc,MAAd;;AAEA,QAAI,KAAK,MAAT,EAAiB;AACf,WAAK,QAAL,CAAc,YAAd,CAA2B,QAA3B,CAAoC,GAApC,CAAwC,UAAU,QAAV,EAAkB;AACxD,QAAA,OAAO,CAAC,GAAR,CAAY,eAAZ,EAA6B,QAAQ,CAAC,MAAT,CAAgB,GAA7C,EAAkD,IAAI,CAAC,SAAL,CAAe,QAAQ,CAAC,IAAxB,EAA8B,KAA9B,CAAoC,CAApC,EAAuC,SAAvC,CAAlD;AACA,eAAO,QAAP;AACD,OAHD,EAGG,gBAAgB,KAAhB,EAA0B;AAC3B,cAAM,OAAO,GAAG,KAAK,CAAC,QAAN,IAAkB,IAAlB,GAAyB,KAAK,CAAC,QAAN,CAAe,IAAxC,GAA+C;AAAE,UAAA,KAAK,EAAE,KAAK,CAAC;AAAf,SAA/D;AACA,cAAM,MAAM,GAAG,CAAE,OAAO,OAAP,KAAmB,QAApB,GAAgC,OAAhC,GAA0C,IAAI,CAAC,SAAL,CAAe,OAAf,CAA3C,EAAoE,KAApE,CAA0E,CAA1E,EAA6E,SAA7E,CAAf;AACA,cAAM,MAAM,GAAG,KAAK,CAAC,QAAN,IAAkB,IAAlB,GAAyB,KAAK,CAAC,QAAN,CAAe,MAAf,CAAsB,GAA/C,GAAqD,KAAK,CAAC,OAA1E;AACA,QAAA,OAAO,CAAC,GAAR,CAAY,eAAZ,EAA6B,MAA7B,EAAqC,MAArC,EAA6C,MAA7C;AACA,eAAO,MAAM,OAAO,CAAC,MAAR,CAAe,KAAf,CAAb;AACD,OATD;AAUD;AACF;;AAEgB,QAAX,WAAW,CAAE,GAAF,EAAe,eAAf,EAAoC;AACnD,QAAI,KAAK,MAAT,EAAiB;AACf,MAAA,OAAO,CAAC,GAAR,CAAY,kBAAZ,EAAgC,GAAhC,EAAqC,IAAI,CAAC,SAAL,CAAe,eAAe,KAAA,IAAf,IAAA,eAAe,KAAA,KAAA,CAAf,GAAA,eAAA,GAAmB,EAAlC,EAAsC,KAAtC,CAA4C,CAA5C,EAA+C,SAA/C,CAArC;AACD;;AAED,UAAM,QAAQ,GAAG,MAAM,KAAK,QAAL,CAAc,OAAd,CAAsB;AAC3C,MAAA,GAD2C;AAE3C,MAAA,MAAM,EAAE,eAAe,IAAI,IAAnB,GAA0B,MAA1B,GAAmC,KAFA;AAG3C,MAAA,IAAI,EAAE;AAHqC,KAAtB,CAAvB;AAKA,WAAO,QAAQ,CAAC,IAAhB;AACD;;AApCqB;;AAAxB,OAAA,CAAA,WAAA,GAAA,WAAA","sourceRoot":"","sourcesContent":["\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst axios_1 = __importDefault(require(\"axios\"));\r\nconst LOGMAXLEN = 120;\r\nconst DEFAULT_TIMEOUT = 15000;\r\nclass HttpWrapper {\r\n    constructor(opts = {}, logreq = false) {\r\n        this.provider = axios_1.default.create(Object.assign({\r\n            timeout: DEFAULT_TIMEOUT,\r\n            headers: { 'Content-Type': 'application/json' }\r\n        }, opts));\r\n        this.logreq = logreq;\r\n        if (this.logreq) {\r\n            this.provider.interceptors.response.use(function (response) {\r\n                console.log('got response:', response.config.url, JSON.stringify(response.data).slice(0, LOGMAXLEN));\r\n                return response;\r\n            }, async function (error) {\r\n                const errData = error.response != null ? error.response.data : { error: error.message };\r\n                const errStr = ((typeof errData === 'string') ? errData : JSON.stringify(errData)).slice(0, LOGMAXLEN);\r\n                const errUrl = error.response != null ? error.response.config.url : error.address;\r\n                console.log('got response:', errUrl, 'err=', errStr);\r\n                return await Promise.reject(error);\r\n            });\r\n        }\r\n    }\r\n    async sendPromise(url, jsonRequestData) {\r\n        if (this.logreq) {\r\n            console.log('sending request:', url, JSON.stringify(jsonRequestData !== null && jsonRequestData !== void 0 ? jsonRequestData : {}).slice(0, LOGMAXLEN));\r\n        }\r\n        const response = await this.provider.request({\r\n            url,\r\n            method: jsonRequestData != null ? 'POST' : 'GET',\r\n            data: jsonRequestData\r\n        });\r\n        return response.data;\r\n    }\r\n}\r\nexports.HttpWrapper = HttpWrapper;\r\n//# sourceMappingURL=HttpWrapper.js.map"]},"metadata":{},"sourceType":"script"}